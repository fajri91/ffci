jamie vardy's crisp finish from a lightning break gave leicester the lead on 18 minutes - but he was then sent off after getting a second yellow card for diving when he tangled with angelo ogbonna early in the second half.
referee jonathan moss made himself even more unpopular when he awarded west ham a penalty with six minutes left.
there had been pushing and pulling in both penalty areas but he decided to punish wes morgan for pulling back winston reid at a corner.
analysis: motd2 pundits on referee's 'mind-boggling inconsistencies'
substitute andy carroll slotted home to end leicester's run of 574 minutes without conceding a league goal and aaron cresswell looked to have opened the door to the foxes' title rivals spurs with a stunning left-footed finish two minutes later.
as the game went into injury time, moss produced another controversial decision when he pointed to the spot once more after carroll made the merest contact with jeff schlupp.
west ham clearly felt moss had evened things up after earlier decisions in their favour, but ulloa was not concerned as he took the chance to secure what might yet be a vital point - although leicester will be without vardy for next weekend's home game with swansea.
relive the action from the king power stadium
leicester's fans celebrated at the end before turning their anger on referee moss - although it was his very questionable decision that allowed them to earn that point at the end.
psychologically, this point could be vital because a loss might just have produced a few doubts and given spurs just a little more wiggle room going into their game at stoke on monday.
it means leicester's last premier league defeat is still that last-minute loss at arsenal on valentine's day and their spirits will be lifted by the manner in which they earned a point when it seemed certain they would end up empty-handed.
referee moss was surrounded by players of both sides and escorted from the field by stewards to jeering from the home fans at the final whistle.
moss's eventful second half began after 56 minutes when he penalised vardy for simulation as he tumbled theatrically under a challenge from ogbonna.
having already given vardy a yellow card, he felt obliged to give a second.
vardy made the most of the contact and ran the risk of punishment.
and he has been accused of doing this before this season.
opinion was split but plenty felt moss was right.
for west ham's penalty, there was undoubtedly pulling and pushing between morgan and winston reid - so again moss had justification.
the difficulty, the inconsistency, is that similar behaviour had been going on in both penalty areas all afternoon without punishment - so why did moss decide this was the time to penalise it?
too often, these decisions seem arbitrary, as was demonstrated when ogbonna dragged huth to the floor even more unceremoniously a few minutes later and no foul was given.
finally, in injury time and with an atmosphere of chaos engulfing the game, moss pointed to the spot for the slightest touch from carroll on schlupp.
it was incredibly harsh and the hammers clearly felt moss had punished them to make up for earlier decisions given against leicester.
it is a tough job - as the abuse directed the referee's way at the end proved.
not as much as there might have been had ulloa not scored at the end, but they can apply pressure and move to within five points of leicester if they win at stoke.
leicester at least have the point in the bag but mauricio pochettino and his players will just feel the door is ajar, even if they know time and games are running out.
leicester boss claudio ranieri: "it was a very tough match.
we were lucky at the beginning when they touched both posts.
after that we scored a great goal and we had an opportunity to finish the match at the beginning of the second half.
media playback is not supported on this device
"after then sending off it changed our match.
"i never spoke about the decision of the referee.
two yellow cards, that's it.
"our performance 11 v 11 and 10 v 11 was fantastic."
west ham manager slaven bilic: "it was a good game of football.
we showed determination, character and quality.
we turned the game around.
we were dangerous, and after sending off we totally dominated the game.
media playback is not supported on this device
"after our second goal i thought we had done enough to win the game, maybe we could have coped with added time better in terms of keeping the ball but they took the risk.
"it was extremely hard for referee, but i mean that was no penalty at all."
leicester - minus the suspended vardy - are at home to swansea next sunday.
the hammers host watford on wednesday.
match ends, leicester city 2, west ham united 2.
second half ends, leicester city 2, west ham united 2.
goal!
 leicester city 2, west ham united 2.
leonardo ulloa (leicester city) converts the penalty with a right footed shot to the bottom right corner.
penalty conceded by andy carroll (west ham united) after a foul in the penalty area.
penalty leicester city.
jeffrey schlupp draws a foul in the penalty area.
offside, leicester city.
danny simpson tries a through ball, but leonardo ulloa is caught offside.
manuel lanzini (west ham united) wins a free kick in the defensive half.
foul by n'golo kanté (leicester city).
attempt missed.
emmanuel emenike (west ham united) right footed shot from outside the box misses to the left.
attempt missed.
robert huth (leicester city) header from the centre of the box misses to the right.
assisted by christian fuchs.
foul by andy carroll (west ham united).
leonardo ulloa (leicester city) wins a free kick in the attacking half.
foul by angelo ogbonna (west ham united).
leonardo ulloa (leicester city) wins a free kick on the right wing.
goal!
 leicester city 1, west ham united 2.
aaron cresswell (west ham united) left footed shot from the left side of the box to the top right corner.
goal!
 leicester city 1, west ham united 1.
andy carroll (west ham united) converts the penalty with a left footed shot to the bottom right corner.
penalty west ham united.
winston reid draws a foul in the penalty area.
penalty conceded by wes morgan (leicester city) after a foul in the penalty area.
corner,  west ham united.
conceded by wes morgan.
attempt missed.
enner valencia (west ham united) right footed shot from the centre of the box misses to the left.
assisted by cheikhou kouyaté.
attempt missed.
cheikhou kouyaté (west ham united) header from the centre of the box misses to the right.
assisted by aaron cresswell with a cross.
enner valencia (west ham united) wins a free kick in the defensive half.
foul by jeffrey schlupp (leicester city).
attempt missed.
dimitri payet (west ham united) right footed shot from outside the box is too high from a direct free kick.
substitution, leicester city.
daniel amartey replaces riyad mahrez.
wes morgan (leicester city) is shown the yellow card for a bad foul.
andy carroll (west ham united) wins a free kick in the attacking half.
foul by wes morgan (leicester city).
corner,  west ham united.
conceded by n'golo kanté.
attempt missed.
emmanuel emenike (west ham united) right footed shot from outside the box is just a bit too high.
substitution, west ham united.
enner valencia replaces victor moses.
hand ball by aaron cresswell (west ham united).
foul by winston reid (west ham united).
leonardo ulloa (leicester city) wins a free kick in the defensive half.
attempt missed.
manuel lanzini (west ham united) right footed shot from outside the box is just a bit too high.
assisted by dimitri payet.
substitution, west ham united.
manuel lanzini replaces mark noble.
winston reid (west ham united) hits the right post with a right footed shot from very close range.
assisted by dimitri payet with a cross following a corner.
corner,  west ham united.
conceded by robert huth.
substitution, leicester city.
leonardo ulloa replaces shinji okazaki.
foul by michail antonio (west ham united).