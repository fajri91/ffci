tries from macgraff leuluai, ah van and chris bridge gave widnes a 14-6 half-time lead, with cas loanee paddy flynn responding against his parent club.
flynn scored another early in the second, but ah van, lloyd white (2) and joe mellor tries made it 38-12.
despite three cas tries in four minutes - larne patrick, luke gale and flynn's hat-trick score - widnes held on.
the vikings' victory had looked assured when mellor took advantage of castleford indecision on a short kick-off, running straight through to help them to a 26-point lead.
but, having lost nine of their previous 10 matches, their defence creaked as they let patrick, who has just signed a three-year deal to move from huddersfield after his loan spell, in for a try.
gale and flynn - on loan at castleford from the vikings until the end of the season - made it a nervy finish, but the tigers suffered their fourth consecutive home league defeat.
widnes moved above wakefield into seventh, while castleford remain in sixth, one point above the vikings.
castleford: solomona, monaghan, crooks, webster, flynn, mcshane, gale, jewitt, milner, patrick, moors, mcmeeken, massey.
replacements: millington, springer, tickle, cook.
widnes: hanbury, thompson, runciman, bridge, ah van, mellor,brown, cahill, white, buchanan, whitley, dean, leuluai.
replacements: j. chapelhow, manuokafoa, walker, heremaia.
referee: j smith